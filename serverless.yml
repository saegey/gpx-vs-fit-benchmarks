service: gpx-vs-fit-benchmarks
frameworkVersion: "3"
package:
  individually: true

provider:
  name: aws
  region: us-west-2
  runtime: nodejs20.x
  memorySize: 1024
  timeout: 120
  iam:
    role:
      statements:
        - Effect: Allow
          Action:
            - logs:CreateLogGroup
            - logs:CreateLogStream
            - logs:PutLogEvents
          Resource: "*"
  environment:
    COMMIT_SHA: ${env:COMMIT_SHA, 'dev'}

functions:
  nodeBench:
    runtime: nodejs20.x
    handler: node-bench/handler.run
    package:
      patterns:
        - node-bench/** # include your code
        - "!node-bench/**/*.test.*"
        - "!**/.DS_Store"
        # If run.js requires deps installed in node-bench/node_modules, include them:
        - node-bench/node_modules/**
    events:
      # - schedule: rate(6 hours)   # optional

  pythonBench:
    runtime: python3.11 # was python3.12 (not allowed in v3 list)
    handler: python_bench/handler.lambda_handler
    package:
      patterns:
        - python_bench/**
        - "!**/*.test.*"
    events:
      # - schedule: rate(6 hours)   # optional

  goBench:
    runtime: provided.al2023
    handler: bootstrap
    package:
      artifact: dist/go-bench.zip # build step should zip bootstrap binary + go-bench assets
    events:
      # - schedule: rate(6 hours)   # optional

  rubyBench:
    runtime: ruby3.2
    handler: ruby_bench/handler.handle
    package:
      patterns:
        - ruby_bench/**
        - "!ruby_bench/**/*.test.*"
        - "!**/.DS_Store"
